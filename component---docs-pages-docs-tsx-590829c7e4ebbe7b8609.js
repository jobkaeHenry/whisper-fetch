"use strict";(self.webpackChunk_jobkaehenry_whisper_fetch=self.webpackChunk_jobkaehenry_whisper_fetch||[]).push([[453],{759:function(e,t,n){n.d(t,{A:function(){return c}});var a=n(758),r=n(4142);var l=e=>{let{items:t}=e;const{0:n,1:r}=(0,a.useState)("");(0,a.useEffect)(()=>{const e=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&r(e.target.id)})},{rootMargin:"-80px 0px -80% 0px"});return t.forEach(t=>{const n=document.getElementById(t.id);n&&e.observe(n)}),()=>{e.disconnect()}},[t]);return a.createElement("nav",{className:"table-of-contents"},a.createElement("h4",{className:"toc-title"},"목차"),a.createElement("ul",{className:"toc-list"},t.map(e=>a.createElement("li",{key:e.id,className:"toc-item toc-level-"+e.level+" "+(n===e.id?"active":"")},a.createElement("a",{href:"#"+e.id,onClick:t=>((e,t)=>{e.preventDefault();const n=document.getElementById(t);if(n){const e=n.offsetTop-100;window.scrollTo({top:e,behavior:"smooth"}),window.history.pushState(null,"","#"+t)}})(t,e.id),className:"toc-link"},e.text)))))};var c=e=>{let{children:t}=e;const{0:n,1:c}=(0,a.useState)([]),{0:o,1:s}=(0,a.useState)(!1);(0,a.useEffect)(()=>{const e=document.querySelectorAll("h2, h3"),t=[];e.forEach(e=>{const n=e.id,a=e.textContent||"",r=parseInt(e.tagName.substring(1));n&&a&&t.push({id:n,text:a,level:r})}),c(t)},[t]);const i=()=>{s(!o)};return a.createElement(r.A,null,a.createElement("div",{className:"doc-layout"},a.createElement("button",{className:"sidebar-toggle",onClick:i,"aria-label":"Toggle sidebar"},o?"✕":"☰"),a.createElement("aside",{className:"doc-sidebar "+(o?"open":"")},a.createElement("div",{className:"doc-sidebar-content"},n.length>0&&a.createElement(l,{items:n}))),o&&a.createElement("div",{className:"sidebar-overlay",onClick:i,"aria-hidden":"true"}),a.createElement("div",{className:"doc-content"},t)))}},6559:function(e,t,n){n.r(t),n.d(t,{Head:function(){return c}});var a=n(758),r=n(759),l=n(6681);t.default=()=>a.createElement(r.A,null,a.createElement("div",{className:"section"},a.createElement("h1",{id:"docs"},"문서"),a.createElement("p",null,"Whisper Fetch의 완전한 사용 가이드입니다.")),a.createElement("div",{className:"section"},a.createElement("h2",{id:"installation"},"설치"),a.createElement(l.A,{code:"npm install @jobkaehenry/whisper-fetch",language:"bash",title:"Terminal"})),a.createElement("div",{className:"section"},a.createElement("h2",{id:"basic-usage"},"기본 사용법"),a.createElement("h3",{id:"create-prefetcher"},"BackgroundPrefetcher 생성"),a.createElement(l.A,{code:"import { BackgroundPrefetcher } from '@jobkaehenry/whisper-fetch';\n\nconst prefetcher = new BackgroundPrefetcher({\n  url: 'https://cdn.example.com/large-file.bin',\n  onProgress: (downloaded, total) => {\n    const progress = total ? (downloaded / total) * 100 : 0;\n    console.log(`진행률: ${progress.toFixed(2)}%`);\n  },\n  onStatus: (status, error) => {\n    console.log('상태:', status);\n    if (error) console.error('에러:', error);\n  }\n});\n\n// 다운로드 시작\nawait prefetcher.start();",language:"typescript",title:"index.ts"}),a.createElement("h3",{id:"download-control"},"다운로드 제어"),a.createElement(l.A,{code:"// 일시정지\nprefetcher.pause();\n\n// 재개\nawait prefetcher.resume();\n\n// 중지 및 정리\nprefetcher.stop();\n\n// 완료된 파일 가져오기\nconst objectURL = await prefetcher.getObjectURL();\nif (objectURL) {\n  const link = document.createElement('a');\n  link.href = objectURL;\n  link.download = 'file.bin';\n  link.click();\n}",language:"typescript",title:"control.ts"})),a.createElement("div",{className:"section"},a.createElement("h2",{id:"options"},"옵션"),a.createElement("div",{className:"api-method"},a.createElement("h4",{id:"option-url"},"url: string"),a.createElement("p",null,"다운로드할 파일의 URL (필수)")),a.createElement("div",{className:"api-method"},a.createElement("h4",{id:"option-cellular"},"allowOnCellular?: boolean"),a.createElement("p",null,"셀룰러 네트워크에서 다운로드 허용 여부 (기본값: false)"),a.createElement(l.A,{code:"const prefetcher = new BackgroundPrefetcher({\n  url: 'https://...',\n  allowOnCellular: true  // 셀룰러에서도 다운로드\n});",language:"typescript"})),a.createElement("div",{className:"api-method"},a.createElement("h4",{id:"option-savedata"},"respectSaveData?: boolean"),a.createElement("p",null,"사용자의 데이터 절약 모드 존중 여부 (기본값: true)"),a.createElement(l.A,{code:"const prefetcher = new BackgroundPrefetcher({\n  url: 'https://...',\n  respectSaveData: true  // 데이터 절약 모드 시 다운로드 안함\n});",language:"typescript"})),a.createElement("div",{className:"api-method"},a.createElement("h4",{id:"option-downlink"},"minDownlinkMbps?: number"),a.createElement("p",null,"최소 네트워크 속도 (Mbps) (기본값: 2)"),a.createElement(l.A,{code:"const prefetcher = new BackgroundPrefetcher({\n  url: 'https://...',\n  minDownlinkMbps: 5  // 5Mbps 이상일 때만 다운로드\n});",language:"typescript"})),a.createElement("div",{className:"api-method"},a.createElement("h4",{id:"option-chunksize"},"chunkSize?: number"),a.createElement("p",null,"청크 크기 (바이트). 생략 시 네트워크 상태에 따라 자동 조정 (512KB~4MB)"),a.createElement(l.A,{code:"const prefetcher = new BackgroundPrefetcher({\n  url: 'https://...',\n  chunkSize: 1024 * 1024  // 1MB 고정\n});",language:"typescript"})),a.createElement("div",{className:"api-method"},a.createElement("h4",{id:"option-integrity"},"integritySha256?: string"),a.createElement("p",null,"완료 시 검증할 SHA-256 해시 (선택사항)"),a.createElement(l.A,{code:"const prefetcher = new BackgroundPrefetcher({\n  url: 'https://...',\n  integritySha256: 'abc123...'  // 다운로드 완료 후 해시 검증\n});",language:"typescript"})),a.createElement("div",{className:"api-method"},a.createElement("h4",{id:"option-store"},"store?: 'opfs' | 'idb'"),a.createElement("p",null,"저장소 타입 (기본값: 'opfs', 폴백 지원)"),a.createElement(l.A,{code:"const prefetcher = new BackgroundPrefetcher({\n  url: 'https://...',\n  store: 'idb'  // IndexedDB 강제 사용\n});",language:"typescript"}))),a.createElement("div",{className:"section"},a.createElement("h2",{id:"react-hook"},"React Hook 사용법"),a.createElement("h3",{id:"use-prefetcher"},"usePrefetcher"),a.createElement(l.A,{code:"import { usePrefetcher } from '@jobkaehenry/whisper-fetch/react';\n\nfunction FileDownloader() {\n  const {\n    status,      // 'idle' | 'started' | 'paused' | 'resumed' | 'completed' | 'error'\n    progress,    // 0-100\n    start,\n    pause,\n    resume,\n    stop,\n    objectURL\n  } = usePrefetcher({\n    url: 'https://cdn.example.com/large-file.bin',\n    integritySha256: 'optional-hash...'\n  });\n\n  return (\n    <div>\n      <p>상태: {status}</p>\n      <p>진행률: {progress.toFixed(2)}%</p>\n\n      <button onClick={start} disabled={status !== 'idle'}>\n        시작\n      </button>\n      <button onClick={pause} disabled={status !== 'started'}>\n        일시정지\n      </button>\n      <button onClick={resume} disabled={status !== 'paused'}>\n        재개\n      </button>\n      <button onClick={stop}>\n        중지\n      </button>\n\n      {objectURL && (\n        <a href={objectURL} download=\"file.bin\">\n          다운로드\n        </a>\n      )}\n    </div>\n  );\n}",language:"tsx",title:"FileDownloader.tsx"})),a.createElement("div",{className:"section"},a.createElement("h2",{id:"prefetch-manager"},"병렬 URL 다운로드 (PrefetchManager)"),a.createElement("p",null,"여러 URL을 동시에 다운로드하여 병목 현상을 제거합니다."),a.createElement("h3",{id:"manager-basic"},"기본 사용법"),a.createElement(l.A,{code:"import { PrefetchManagerImpl } from '@jobkaehenry/whisper-fetch';\n\n// 동시에 5개까지 다운로드\nconst manager = new PrefetchManagerImpl(5);\n\n// 단일 URL 추가\nconst id = manager.add({\n  url: 'https://cdn.example.com/video1.mp4',\n  priority: 10,  // 높을수록 우선순위가 높음\n  onProgress: (done, total) => console.log(`${done}/${total}`)\n});\n\n// 여러 URL 일괄 추가\nconst ids = manager.addBatch([\n  'https://cdn.example.com/video1.mp4',\n  'https://cdn.example.com/video2.mp4',\n  { url: 'https://cdn.example.com/video3.mp4', priority: 5 }\n]);",language:"typescript",title:"manager.ts"}),a.createElement("h3",{id:"manager-control"},"상태 확인 및 제어"),a.createElement(l.A,{code:"// 상태 확인\nconst status = manager.getStatus(id);\n// { status: 'active' | 'queued', progress: { done: number, total?: number } }\n\n// 동시 다운로드 수 동적 변경\nmanager.setMaxConcurrent(10);\n\n// 일시정지/재개/중단\nmanager.pause(id);      // 특정 ID만\nmanager.pause();        // 전체 일시정지\nmanager.resume(id);     // 특정 ID만\nmanager.resume();       // 전체 재개\nmanager.stop(id);       // 특정 ID만\nmanager.stop();         // 전체 중단\n\n// 제거\nmanager.remove(id);\nawait manager.purge(id);",language:"typescript",title:"control.ts"}),a.createElement("h3",{id:"manager-example"},"실사용 예제"),a.createElement(l.A,{code:"// 대용량 비디오 여러 개 미리 다운로드\nconst manager = new PrefetchManagerImpl(3);\nconst videoIds = manager.addBatch([\n  { url: '/videos/ep1.mp4', priority: 10 },  // 현재 에피소드는 우선순위 높게\n  { url: '/videos/ep2.mp4', priority: 5 },\n  { url: '/videos/ep3.mp4', priority: 1 }\n]);\n\n// 네트워크 상태에 따라 동시 다운로드 수 조정\nif (navigator.connection?.effectiveType === '4g') {\n  manager.setMaxConcurrent(10);\n} else {\n  manager.setMaxConcurrent(2);\n}",language:"typescript",title:"video-prefetch.ts"})),a.createElement("div",{className:"section"},a.createElement("h2",{id:"events"},"이벤트"),a.createElement("p",null,"BackgroundPrefetcher는 다양한 상태 이벤트를 발생시킵니다:"),a.createElement("div",{className:"api-method"},a.createElement("h4",{id:"event-started"},"started"),a.createElement("p",null,"프리페치 루프가 시작됨")),a.createElement("div",{className:"api-method"},a.createElement("h4",{id:"event-paused"},"paused"),a.createElement("p",null,"포그라운드 활동 또는 수동 일시정지로 인해 중단됨")),a.createElement("div",{className:"api-method"},a.createElement("h4",{id:"event-resumed"},"resumed"),a.createElement("p",null,"유휴 상태 후 재개됨")),a.createElement("div",{className:"api-method"},a.createElement("h4",{id:"event-completed"},"completed"),a.createElement("p",null,"모든 바이트를 가져와 조립 완료")),a.createElement("div",{className:"api-method"},a.createElement("h4",{id:"event-stopped"},"stopped"),a.createElement("p",null,"stop() 호출로 중지됨")),a.createElement("div",{className:"api-method"},a.createElement("h4",{id:"event-error"},"error"),a.createElement("p",null,"복구 불가능한 오류 발생"))),a.createElement("div",{className:"section"},a.createElement("h2",{id:"advanced"},"고급 사용법"),a.createElement("h3",{id:"storage-selection"},"저장소 선택"),a.createElement("p",null,"Whisper Fetch는 두 가지 저장소 메커니즘을 지원합니다:"),a.createElement("ul",null,a.createElement("li",null,a.createElement("strong",null,"OPFS (Origin Private File System)"),": Chrome 114+ 에서 지원. 스트리밍 쓰기로 최고의 성능 제공"),a.createElement("li",null,a.createElement("strong",null,"IndexedDB"),": 모든 최신 브라우저에서 지원. OPFS를 사용할 수 없을 때 자동 폴백")),a.createElement("h3",{id:"integrity-verification"},"무결성 검증"),a.createElement("p",null,"integritySha256 옵션을 제공하면, 다운로드가 완료된 후 조립된 Blob에 대해 SHA-256 해시를 검증합니다. 해시가 일치하지 않으면 'error' 이벤트가 발생합니다."),a.createElement(l.A,{code:"const prefetcher = new BackgroundPrefetcher({\n  url: 'https://cdn.example.com/file.bin',\n  integritySha256: 'expected-sha256-hash',\n  onStatus: (status, error) => {\n    if (status === 'error') {\n      console.error('무결성 검증 실패:', error);\n    }\n  }\n});",language:"typescript",title:"verify.ts"}),a.createElement("h3",{id:"network-conditions"},"네트워크 조건 제어"),a.createElement("p",null,"모바일 데이터 사용량과 사용자 경험을 최적화하기 위해 다양한 네트워크 조건을 제어할 수 있습니다:"),a.createElement(l.A,{code:"const prefetcher = new BackgroundPrefetcher({\n  url: 'https://cdn.example.com/large-video.mp4',\n  allowOnCellular: false,      // Wi-Fi에서만 다운로드\n  respectSaveData: true,       // 데이터 절약 모드 존중\n  minDownlinkMbps: 5,          // 최소 5Mbps 필요\n  chunkSize: undefined         // 네트워크 속도에 따라 자동 조정\n});",language:"typescript",title:"network.ts"})),a.createElement("div",{className:"section"},a.createElement("h2",{id:"server-requirements"},"서버 요구사항"),a.createElement("p",null,"Whisper Fetch가 올바르게 작동하려면 서버가 다음을 지원해야 합니다:"),a.createElement("h3",{id:"required"},"필수 요구사항"),a.createElement("ul",null,a.createElement("li",null,a.createElement("strong",null,"HTTP Range 요청"),": 206 Partial Content 응답 지원")),a.createElement("h3",{id:"recommended"},"권장 사항"),a.createElement("ul",null,a.createElement("li",null,a.createElement("strong",null,"ETag 헤더"),": 파일 변경 감지를 위해"),a.createElement("li",null,a.createElement("strong",null,"If-Range 지원"),": 안전한 Range 요청 재개를 위해")),a.createElement("p",null,"대부분의 CDN (CloudFlare, AWS CloudFront, Fastly 등)은 이러한 요구사항을 기본적으로 지원합니다.")),a.createElement("div",{className:"section"},a.createElement("h2",{id:"nextjs"},"Next.js 사용법"),a.createElement("p",null,"Next.js에서 Whisper Fetch를 사용할 때는 클라이언트 사이드에서만 실행되도록 해야 합니다:"),a.createElement(l.A,{code:"'use client';  // Next.js 13+ App Router\n\nimport { usePrefetcher } from '@jobkaehenry/whisper-fetch/react';\n\nexport default function VideoPage() {\n  const { status, progress, objectURL } = usePrefetcher({\n    url: 'https://cdn.example.com/video.mp4'\n  });\n\n  return (\n    <div>\n      <p>진행률: {progress}%</p>\n      {objectURL && <video src={objectURL} controls />}\n    </div>\n  );\n}",language:"tsx",title:"VideoPage.tsx"}),a.createElement("p",null,"Pages Router를 사용하는 경우:"),a.createElement(l.A,{code:"import dynamic from 'next/dynamic';\n\nconst VideoPlayer = dynamic(() => import('../components/VideoPlayer'), {\n  ssr: false  // SSR 비활성화\n});\n\nexport default function Page() {\n  return <VideoPlayer />;\n}",language:"tsx",title:"Page.tsx"})),a.createElement("div",{className:"section"},a.createElement("h2",{id:"testing"},"테스팅"),a.createElement("h3",{id:"unit-tests"},"단위 테스트"),a.createElement(l.A,{code:"npm test",language:"bash",title:"Terminal"}),a.createElement("h3",{id:"e2e-tests"},"E2E 테스트 (Playwright)"),a.createElement(l.A,{code:"npm run build\nnpx playwright test",language:"bash",title:"Terminal"})));const c=()=>a.createElement("title",null,"문서 - Whisper Fetch")}}]);
//# sourceMappingURL=component---docs-pages-docs-tsx-590829c7e4ebbe7b8609.js.map